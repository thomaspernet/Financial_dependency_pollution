{"GLOBAL": {"DATABASE": "", "QUERIES_OUTPUT": "SQL_OUTPUT_ATHENA"}, "TABLES": {"CREATION": {"ALL_SCHEMA": [{"description": "Create Firms survey ASIF panel data from STATA", "schema": [{"Name": "firm", "Type": "string", "Comment": "firm ID"}, {"Name": "year", "Type": "string", "Comment": "balance sheet year"}, {"Name": "export", "Type": "int", "Comment": "Where: export delivery value"}, {"Name": "dq", "Type": "string", "Comment": "Province county code"}, {"Name": "name", "Type": "string", "Comment": "Corporate Name"}, {"Name": "town", "Type": "string", "Comment": "Township (town)"}, {"Name": "village", "Type": "string", "Comment": "Street (village), house number"}, {"Name": "street", "Type": "string", "Comment": "Street office"}, {"Name": "c15", "Type": "string", "Comment": "Community (neighborhood) and village committee"}, {"Name": "zip", "Type": "string", "Comment": "Zip code"}, {"Name": "product1_", "Type": "string", "Comment": "The main products (1)"}, {"Name": "c26", "Type": "string", "Comment": "The main products (2)"}, {"Name": "c27", "Type": "string", "Comment": "The main products (3)"}, {"Name": "cic", "Type": "string", "Comment": "Industry Code"}, {"Name": "type", "Type": "string", "Comment": "Registration Type"}, {"Name": "c44", "Type": "string", "Comment": "Holding case"}, {"Name": "c45", "Type": "string", "Comment": "Affiliation"}, {"Name": "setup", "Type": "string", "Comment": "year of creation"}, {"Name": "c47", "Type": "int", "Comment": "Opening (established) time - months"}, {"Name": "c60", "Type": "int", "Comment": "Code-scale enterprises"}, {"Name": "c61", "Type": "int", "Comment": "Light and heavy industrial codes"}, {"Name": "employ", "Type": "int", "Comment": "Employement"}, {"Name": "c69", "Type": "int", "Comment": "Industrial output (constant prices)"}, {"Name": "output", "Type": "int", "Comment": "Industrial output value (current prices)"}, {"Name": "new_product", "Type": "int", "Comment": "Where: New product output value"}, {"Name": "c74", "Type": "int", "Comment": "Industrial sales output value (current prices)"}, {"Name": "addval", "Type": "int", "Comment": "Value added"}, {"Name": "cuasset", "Type": "int", "Comment": "Current asset"}, {"Name": "c80", "Type": "int", "Comment": "Accounts Receivable"}, {"Name": "c81", "Type": "int", "Comment": "stock"}, {"Name": "c82", "Type": "int", "Comment": "Wherein: Finished"}, {"Name": "c83", "Type": "int", "Comment": "The average balance of current assets"}, {"Name": "c84", "Type": "int", "Comment": "Long-term investment"}, {"Name": "c85", "Type": "int", "Comment": "Total fixed assets (deprecated)"}, {"Name": "tofixed", "Type": "int", "Comment": "Total fixed assets (to use)"}, {"Name": "c87", "Type": "int", "Comment": "Where: the production and operation with"}, {"Name": "todepre", "Type": "int", "Comment": "total depreciation"}, {"Name": "cudepre", "Type": "int", "Comment": "current depreciation"}, {"Name": "netfixed", "Type": "int", "Comment": "net fixed asset"}, {"Name": "c91", "Type": "int", "Comment": "Intangible and Deferred"}, {"Name": "c92", "Type": "int", "Comment": "Intangible assets"}, {"Name": "toasset", "Type": "int", "Comment": "Total asset"}, {"Name": "c95", "Type": "int", "Comment": "Total current liabilities"}, {"Name": "c97", "Type": "int", "Comment": "Total long-term liabilities"}, {"Name": "c98", "Type": "int", "Comment": "Total Liabilities"}, {"Name": "c99", "Type": "int", "Comment": "Total shareholders' equity"}, {"Name": "captal", "Type": "int", "Comment": "Capital"}, {"Name": "e_state", "Type": "int", "Comment": "Where: National Capital"}, {"Name": "e_collective", "Type": "int", "Comment": "Collective capital"}, {"Name": "e_legal_person", "Type": "int", "Comment": "Corporate capital"}, {"Name": "e_individual", "Type": "int", "Comment": "Personal Capital"}, {"Name": "e_HMT", "Type": "int", "Comment": "Hong Kong, Macao and Taiwan capital"}, {"Name": "e_foreign", "Type": "int", "Comment": "Foreign capital"}, {"Name": "sales", "Type": "int", "Comment": "Sales revenue"}, {"Name": "c108", "Type": "int", "Comment": "Main business cost"}, {"Name": "c113", "Type": "int", "Comment": "Operating expenses"}, {"Name": "c110", "Type": "int", "Comment": "The main business tax and surcharges"}, {"Name": "c111", "Type": "int", "Comment": "sales profit"}, {"Name": "c114", "Type": "int", "Comment": "Management fees"}, {"Name": "c115", "Type": "int", "Comment": "Where: Taxes"}, {"Name": "c116", "Type": "int", "Comment": "Property insurance"}, {"Name": "c118", "Type": "int", "Comment": "Labor, unemployment insurance"}, {"Name": "c124", "Type": "int", "Comment": "Financial expenses"}, {"Name": "c125", "Type": "int", "Comment": "Of which: Interest expense"}, {"Name": "profit", "Type": "int", "Comment": "operating profit"}, {"Name": "c128", "Type": "int", "Comment": "Subsidy income"}, {"Name": "c131", "Type": "int", "Comment": "The total profit"}, {"Name": "c132", "Type": "int", "Comment": "Total loss"}, {"Name": "c133", "Type": "int", "Comment": "Total profit and tax"}, {"Name": "c134", "Type": "int", "Comment": "Income tax payable"}, {"Name": "c136", "Type": "int", "Comment": "Profit payable"}, {"Name": "wage", "Type": "int", "Comment": "Wages of the year"}, {"Name": "c140", "Type": "int", "Comment": "Where: Main Wages of business"}, {"Name": "c141", "Type": "int", "Comment": "This year the total amount of welfare payable (credit accumulated amount)"}, {"Name": "c142", "Type": "int", "Comment": "Where: Main business cope with the total welfare"}, {"Name": "c143", "Type": "int", "Comment": "Payable VAT"}, {"Name": "c144", "Type": "int", "Comment": "Input tax year"}, {"Name": "c145", "Type": "int", "Comment": "Output tax year"}, {"Name": "midput", "Type": "int", "Comment": "intermediate inputs"}, {"Name": "c62", "Type": "int", "Comment": "Persons Employed Total Total _"}, {"Name": "c147", "Type": "int", "Comment": "Taxes (processing)"}, {"Name": "c64", "Type": "int", "Comment": "Total annual revenue"}, {"Name": "c65", "Type": "int", "Comment": "Where: Main business revenue"}, {"Name": "c93", "Type": "int", "Comment": "Total assets 318"}, {"Name": "c16", "Type": "int", "Comment": "Provinces"}, {"Name": "c9", "Type": "string", "Comment": "State / Province / State)"}, {"Name": "c10", "Type": "string", "Comment": "The (autonomous regions and municipalities, prefectures and leagues)"}, {"Name": "c11", "Type": "string", "Comment": "Counties (districts, cities, flag)"}, {"Name": "c17", "Type": "string", "Comment": "Area Code"}, {"Name": "c29", "Type": "string", "Comment": "Registration (or approval) authority - the administrative department for industry and commerce"}, {"Name": "c167", "Type": "string", "Comment": "Founded union situation"}, {"Name": "c168", "Type": "int", "Comment": "unionized"}, {"Name": "v90", "Type": "int", "Comment": "number_unionized"}, {"Name": "c79", "Type": "int", "Comment": "short_term_investments"}, {"Name": "c96", "Type": "int", "Comment": "accounts_Payable"}, {"Name": "c117", "Type": "int", "Comment": "travel"}, {"Name": "c119", "Type": "int", "Comment": "union_funds"}, {"Name": "c121", "Type": "int", "Comment": "administrative_expenses"}, {"Name": "trainfee", "Type": "int", "Comment": "trainfee"}, {"Name": "c123", "Type": "int", "Comment": "sewage_charges"}, {"Name": "c127", "Type": "int", "Comment": "investment_income"}, {"Name": "c135", "Type": "int", "Comment": "advertising_fee"}, {"Name": "c120", "Type": "int", "Comment": "pension_medical_insurance"}, {"Name": "c138", "Type": "int", "Comment": "housing_fund"}, {"Name": "c148", "Type": "int", "Comment": "direct_aterial"}, {"Name": "c149", "Type": "int", "Comment": "intermediate_inputs"}, {"Name": "c150", "Type": "int", "Comment": "middle_management_fees_investment"}, {"Name": "c151", "Type": "int", "Comment": "operating_expenses "}, {"Name": "rdfee", "Type": "int", "Comment": "rdfee"}, {"Name": "c156", "Type": "string", "Comment": "Light and heavy industrial Name"}, {"Name": "c157", "Type": "string", "Comment": "Scale enterprises name"}, {"Name": "citycode", "Type": "string", "Comment": "City code clean by Zhao Ruili using adress"}, {"Name": "prov", "Type": "string", "Comment": ""}], "partition_keys": [], "metadata": {"DatabaseName": "firms_survey", "TablePrefix": "asif_", "target_S3URI": "s3://datalake-datascience/DATA/ECON/FIRM_SURVEY/ASIF_CHINA/UNZIP_DATA_CSV", "from_athena": "False"}}]}, "PREPARATION": {"STEPS": []}, "TRANSFORMATION": {"STEPS": []}}, "ANALYSIS": {"COUNT_MISSING": {"top": "SELECT COUNT(*) as nb_obs, ", "middle": "COUNT(*) - COUNT({0}) AS {0}", "bottom": " FROM {}.{}"}, "CATEGORICAL": {"PAIR": "SELECT {2}, COUNT(*) AS nb_obs FROM {0}.{1} GROUP BY {2} ORDER BY nb_obs DESC ", "MULTI_PAIR": "SELECT {2}, {3}, COUNT(*) AS nb_obs FROM {0}.{1} GROUP BY {2}, {3} ORDER BY nb_obs DESC "}, "CONTINUOUS": {"DISTRIBUTION": {"top_1": "SELECT * FROM (WITH table_wrapper AS (", "top_2": ") SELECT table_wrapper.pct,", "top_3": " FROM table_wrapper ", "middle_1": "  LEFT JOIN ( ", "middle_2": " ) as table_2_{0} ON table_wrapper.pct = table_2_{0}.pct ", "bottom": "WITH table_{3} AS ( SELECT MAP( ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {2}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} ) SELECT pct, value AS {2} FROM table_{3} CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "ONE_PAIR_DISTRIBUTION": {"top_1": "SELECT * FROM (WITH table_wrapper AS (", "top_2": ") SELECT table_wrapper.pct, table_wrapper.{}, ", "top_3": " FROM table_wrapper ", "middle_1": "  LEFT JOIN ( ", "middle_2": " ) as table_2_{0} ON table_wrapper.{1} = table_2_{0}.{1} AND table_wrapper.pct = table_2_{0}.pct ", "bottom": "WITH table_{3} AS ( SELECT {4}, MAP(ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {2}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} GROUP BY {4}) SELECT {4}, pct, value AS {2} FROM table_{3} CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "TWO_PAIRS_DISTRIBUTION": "WITH dataset AS ( SELECT {2}, {3}, MAP( ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {4}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} GROUP BY {2}, {3} ) SELECT {2}, {3}, pct, value AS {4} FROM dataset CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "COUNT_DUPLICATES": {"query": "SELECT CNT, COUNT(*) AS CNT_DUPLICATE FROM ( SELECT {2}, COUNT(*) as CNT FROM {0}.{1} GROUP BY year, {2} ) GROUP BY CNT ORDER BY CNT_DUPLICATE"}}}